(function(){"use strict";var t={4614:function(t,e,o){var a=o(7195),n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view"),e("footer",[t._v("© 2021 Smart Energy Lab. All rights reserved.")])],1)},r=[],s=o(1001),i={},c=(0,s.Z)(i,n,r,!1,null,null,null),l=c.exports,u=o(2241),d=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"login-page"}},[e("div",{staticClass:"fm-container"},[t._m(0),e("form",{attrs:{id:"login-form"},on:{submit:t.login}},[e("div",{staticClass:"form-fields"},[e("div",{staticClass:"custom-input"},[e("font-awesome-icon",{attrs:{icon:"fa-solid fa-user"}}),e("input",{staticClass:"input-field",attrs:{id:"email",type:"email",placeholder:"Email",name:"email"},on:{input:t.handleInput}})],1),e("div",{staticClass:"custom-input"},[e("font-awesome-icon",{attrs:{icon:"fa-solid fa-lock"}}),e("input",{staticClass:"input-field",attrs:{id:"password",type:"password",placeholder:"Password",name:"password"},on:{input:t.handleInput}})],1),e("span")]),e("div",{staticClass:"submit-btn-container"},[e("button",{attrs:{type:"submit",disabled:t.checkValidity()}},[t._v("login")])])])])])},f=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"logo-container"},[e("img",{attrs:{width:"100px",alt:"SmartEnergy logo",src:"https://www.smartenergylab.pt/wp-content/uploads/2021/03/SmartEnergyLab_00_Home_imagens-01.png"}})])}],p=o(6318);o(2801),o(7658);const h=t=>{localStorage.setItem("ACCESS_TOKEN",t)},g=t=>{localStorage.setItem("REFRESH_TOKEN",t)},m=()=>localStorage.getItem("ACCESS_TOKEN"),v=()=>localStorage.getItem("REFRESH_TOKEN");var _=o(8358);const w=_.Z.create({baseURL:"http://localhost:8000/api/v1/",headers:{"Content-type":"application/json",Authorization:"Bearer "+m()}}),b=async()=>{try{const t=v(),e=await w.post("token/refresh/",{refresh:t});return e}catch(t){console.log("Error",t)}};w.interceptors.request.use((async t=>{const e=m();return e&&(t.headers.Authorization=`Bearer ${e}`),t}),(t=>Promise.reject(t))),w.interceptors.response.use((t=>t),(async function(t){const e=t.config;if(401===t.response?.status&&!e._retry){e._retry=!0;const t=await b(),o=t?.data.access;return h(o),w.defaults.headers.common.Authorization=`Bearer ${o}`,w(e)}return Promise.reject(t)}));var y=w;const S=t=>{localStorage.setItem("USER",JSON.stringify(t))},C=()=>JSON.parse(localStorage.getItem("USER")),O=t=>{y.get(`userinfo/users/${t}/`).then((t=>S(t.data))).catch()};var E=o(2782),P=function(t,e,o,a){var n,r=arguments.length,s=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,o,a);else for(var i=t.length-1;i>=0;i--)(n=t[i])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let j=class extends E.w3{constructor(...t){super(...t),(0,p.Z)(this,"formValues",{email:"",password:""}),(0,p.Z)(this,"loading",!1)}checkValidity(){return!(this.formValues.email&&this.formValues.password)||this.loading}handleInput(t){const{name:e,value:o}=t.target;this.formValues={...this.formValues,[e]:o}}login(t){t.preventDefault();const e={email:this.formValues.email,password:this.formValues.password};this.loading=!0,y.post("token/",e).then((t=>{this.loading=!1,h(t.data.access),g(t.data.refresh);const e=window.atob(t.data.access?.split(".")[1]||""),{user_id:o}=JSON.parse(e);return O(o)})).then((()=>{this.$router.push("/dashboard")})).catch((({response:t,message:e})=>{if(this.loading=!1,!t)return alert(e);this.formValues.password="",alert("invalid email or password")}))}mounted(){const t=localStorage.getItem("ACCESS_TOKEN");t&&this.$router.push("/dashboard")}};j=P([E.wA],j);var x=j,k=x,Z=(0,s.Z)(k,d,f,!1,null,"113b1137",null),D=Z.exports,L=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{attrs:{id:"dashboard-page"}},[e("div",{staticClass:"fm-container"},[e("nav",{staticClass:"topbar-nav max-content"},[e("img",{attrs:{width:"80px",alt:"SmartEnergy logo",src:"https://www.smartenergylab.pt/wp-content/uploads/2021/03/SmartEnergyLab_00_Home_imagens-03.png"}}),e("div",{staticClass:"nav-div-83wjdu32"},[e("div",{staticClass:"img-avatar-div-323jhd",on:{mouseover:function(e){t.showLogout=!0}}},[t._m(0),e("span",[t._v("Your Name")])]),t.showLogout?e("div",{staticClass:"logout-div-3jwe42",on:{click:function(e){return t.logout()},mouseleave:function(e){t.showLogout=!1}}},[e("font-awesome-icon",{attrs:{icon:"fa-solid fa-right-from-bracket"}}),t._v(" Logout")],1):t._e()])]),e("div",{staticClass:"body-da23jd",on:{click:function(e){t.showLogout=!1}}},[e("div",{staticClass:"table-container-323u3238 max-content"},[t._m(1),e("table",[t._m(2),t._l(t.chargeSessionCost,(function(o){return e("tr",{key:o.id},[e("td",[t._v(t._s(o.id))]),e("td",[t._v(t._s(o.location))]),e("td",[t._v(t._s(new Intl.NumberFormat("de-DE").format(o.energy_kWh)))]),e("td",[t._v(t._s(new Date(o.charge_datetime).toLocaleDateString().replace(/\//g,"-"))+" "+t._s(new Date(o.charge_datetime).toLocaleTimeString()))]),e("td",[t._v(t._s(new Intl.NumberFormat("de-DE").format(o.cost)))])])}))],2)]),e("pagination",{attrs:{records:200},on:{paginate:t.handlePaginate},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)])])},I=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"img-div-23j3ds"},[e("img",{attrs:{src:"https://via.placeholder.com/50x50.png/8B8B8B/FFFFFF"}})])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"title-div-j434lss"},[e("h2",[t._v("Log Table")])])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("tr",[e("th",[t._v("S/N")]),e("th",[t._v("Location")]),e("th",[t._v("Energy (kWh)")]),e("th",[t._v("Date")]),e("th",[t._v("Cost (€/kWh)")])])}],N=o(6005),R=o.n(N),F=function(t,e,o,a){var n,r=arguments.length,s=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,o):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(t,e,o,a);else for(var i=t.length-1;i>=0;i--)(n=t[i])&&(s=(r<3?n(s):r>3?n(e,o,s):n(e,o))||s);return r>3&&s&&Object.defineProperty(e,o,s),s};let T=class extends E.w3{constructor(...t){super(...t),(0,p.Z)(this,"showLogout",!1),(0,p.Z)(this,"page",1),(0,p.Z)(this,"user",C()),(0,p.Z)(this,"chargeSessionCost",[])}logout(){localStorage.clear(),this.$router.push("/login")}handlePaginate(t){this.page=t,this.getDashboardData(C().id,t)}getDashboardData(t,e){y.get("/chargesessioncost/",{params:{user_info:t,page:e}}).then((t=>{this.chargeSessionCost=t.data})).catch((t=>console.log(t)))}mounted(){const t=m(),e=window.atob(t?.split(".")[1]||"");e||this.$router.push("/login");const{user_id:o}=JSON.parse(e);this.getDashboardData(o,1)}};T=F([(0,E.wA)({components:{Pagination:R()}})],T);var V=T,A=V,$=(0,s.Z)(A,L,I,!1,null,"60811d1c",null),B=$.exports;a.ZP.use(u.ZP);const K=[{path:"/",name:"home",component:D},{path:"/login",name:"login",component:D},{path:"/dashboard",name:"dashboard",component:B}],H=new u.ZP({mode:"history",base:"/",routes:K});var J=H,z=o(4340),U=(o(7024),o(4984)),W=o(5021);z.vI.add(W.BC0,W.byT,W.ILF,W.mXR),a.ZP.component("font-awesome-icon",U.GN),a.ZP.config.productionTip=!1,new a.ZP({router:J,render:t=>t(l)}).$mount("#app")}},e={};function o(a){var n=e[a];if(void 0!==n)return n.exports;var r=e[a]={exports:{}};return t[a](r,r.exports,o),r.exports}o.m=t,function(){var t=[];o.O=function(e,a,n,r){if(!a){var s=1/0;for(u=0;u<t.length;u++){a=t[u][0],n=t[u][1],r=t[u][2];for(var i=!0,c=0;c<a.length;c++)(!1&r||s>=r)&&Object.keys(o.O).every((function(t){return o.O[t](a[c])}))?a.splice(c--,1):(i=!1,r<s&&(s=r));if(i){t.splice(u--,1);var l=n();void 0!==l&&(e=l)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[a,n,r]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var a in e)o.o(e,a)&&!o.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,r,s=a[0],i=a[1],c=a[2],l=0;if(s.some((function(e){return 0!==t[e]}))){for(n in i)o.o(i,n)&&(o.m[n]=i[n]);if(c)var u=c(o)}for(e&&e(a);l<s.length;l++)r=s[l],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return o.O(u)},a=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(4614)}));a=o.O(a)})();
//# sourceMappingURL=app.8ae91201.js.map